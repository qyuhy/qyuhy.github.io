<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[CI,CD流程（一）Docker+Gitlab+Jenkins持续集成]]></title>
    <url>%2F2018%2F04%2F25%2FCI-CD%E6%B5%81%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89Docker-Gitlab-Jenkins%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%2F</url>
    <content type="text"><![CDATA[记录下使用Docker+Gitlab+Jenkins的安装过程，以及所踩得坑。当然这个还是简单的一个持续集成，后续可能会使用docker服务编排的框架进行项目docker化，通过使用harbox，kubernetes可以构建一个完成的CI，CD流程 一个简单的持续集成的方案 下面将按照上述的图来一步步搭建环境 一、安装1.docker安装我使用的是mac版本，下载docker-for-mac,鉴于大家的网路环境，我上传到了百度云，mac安装很简单，直接拖到app中即可。 官网下载地址 https://store.docker.com/editions/community/docker-ce-desktop-mac 百度云下载地址 链接:https://pan.baidu.com/s/1EYghHptrLtXEBsMRFNGmVQ 密码:dxl2 注意，docker安装之后，知道几个常用的国内镜像还是有必要的 docker镜像地址 网易镜像中心https://c.163.com/ dao-cloudhttps://dashboard.daocloud.io/packages/explore 访问这些镜像中心，都需要注册登录才可以使用 2.Gitlab安装使用docker安装gitlab就很简单了，之前在centos6.5上手动安装过gitlab，感觉超级麻烦，现在只需要简单的几步即可。 2.1 拉取gitlab镜像1docker pull gitlab 2.2 启动gitlab最好把下列命令保存为一个shell脚本，先做好初始化工作，在宿主机上建立gitlab数据挂载目录，方便gitlab的版本更换123mkdir configmkdir logsmkdir data 启动gitlab12345678910docker stop gitlabdocker run --detach \ --hostname 127.0.0.1 \ --publish 5551:443 --publish 5555:80 --publish 22:22 \ --name gitlab \ --restart always \ --volume `pwd`/config:/etc/gitlab \ --volume `pwd`/logs:/var/log/gitlab \ --volume `pwd`/data:/var/opt/gitlab \ gitlab/gitlab-ce:latest –rm 代表容器停止后删除该镜像；使用docker ps -a查不到该容器的启动历史 –restart always docker会监听容器的状态，如果容器意外停止，docker会一直尝试重启，保证容器一直处在运行状态 –volume 主要是备份容器数据，假如向切换gitlab版本，只需要拉取特定版本的镜像，指定上述挂载的目录即可 3.Jenkins安装3.1 拉取jenkins镜像1docker pull jenkins 3.2 启动jenkins最好把下列命令保存为一个shell脚本,先做好初始化工作，在宿主机上建立jenkins数据挂载目录，方便jenkins升级1mkdir data 启动jenkins12docker stop jenkinsdocker run -d --rm --name jenkins -p 8080:8080 -p 50000:50000 --net=mynet --net-alias=jenkins -v `pwd`/data:/var/jenkins_home jenkins 二、gitlab与jenkins整合三、gitlab与jenkins在docker中相互依赖互联解决方]]></content>
      <categories>
        <category>持续集成</category>
      </categories>
      <tags>
        <tag>CI</tag>
        <tag>CD</tag>
      </tags>
  </entry>
</search>
